# 数据库配置检查指南

## 🎯 快速检查步骤

### 方法一：使用微信开发者工具（推荐）

1. **打开微信开发者工具**
   - 手动打开微信开发者工具
   - 导入项目：选择 `e:\trae_owd\project_wx` 目录

2. **检查数据库状态**
   - 在模拟器中导航到：`pages/test-db-status/test-db-status`
   - 页面会自动检查所有必需的数据库集合
   - 查看检查结果：
     - ✅ 存在 = 集合已正确创建
     - ❌ 不存在 = 需要初始化

3. **初始化数据库（如果需要）**
   - 如果有集合显示"❌ 不存在"
   - 点击页面上的"初始化数据库"按钮
   - 等待初始化完成

### 方法二：使用完整测试工具

1. **导航到测试页面**
   - 在微信开发者工具中访问：`pages/test-task-flow/test-task-flow`

2. **运行完整检查**
   - 点击"初始化数据库"按钮
   - 点击"开始完整测试"按钮
   - 观察测试结果

## 📋 需要检查的数据库集合

| 集合名称 | 用途 | 重要性 |
|---------|------|--------|
| `demands` | 存储需求信息 | 🔴 必需 |
| `task_applications` | 存储任务申请 | 🔴 必需 |
| `tasks` | 存储正式任务 | 🔴 必需 |
| `messages` | 存储消息通知 | 🟡 重要 |
| `users` | 存储用户信息 | 🟡 重要 |
| `contacts` | 存储联系人 | 🟢 可选 |
| `sms_codes` | 存储短信验证码 | 🟢 可选 |

## 🔧 云开发环境配置

### 检查云开发环境
1. 在微信开发者工具中点击"云开发"
2. 确认环境已创建并激活
3. 检查数据库权限设置

### 云函数部署状态
确认以下云函数已部署：
- ✅ `initDatabase` - 数据库初始化
- ✅ `task` - 任务相关操作
- ✅ `login` - 用户登录
- ✅ `sms` - 短信服务（可选）

## 🚨 常见问题及解决方案

### 问题1：集合不存在
**解决方案：**
1. 使用测试页面的"初始化数据库"功能
2. 或手动在云开发控制台创建集合

### 问题2：权限错误
**解决方案：**
1. 检查数据库权限设置
2. 确保用户已登录
3. 验证云函数权限配置

### 问题3：云函数调用失败
**解决方案：**
1. 检查云函数是否已部署
2. 验证网络连接
3. 查看控制台错误信息

## 📊 配置验证清单

### 基础配置
- [ ] 微信开发者工具已安装并登录
- [ ] 项目已正确导入
- [ ] 云开发环境已创建

### 数据库配置
- [ ] 所有必需集合已创建
- [ ] 数据库权限配置正确
- [ ] 可以正常读写数据

### 云函数配置
- [ ] `initDatabase` 云函数已部署
- [ ] `task` 云函数已部署
- [ ] `login` 云函数已部署
- [ ] 云函数调用正常

### 功能测试
- [ ] 数据库状态检查通过
- [ ] 任务申请功能正常
- [ ] 申请管理功能正常
- [ ] 时间线功能正常

## 🎯 下一步操作

配置检查完成后，您可以：

1. **测试核心功能**
   - 使用 `pages/test-task-flow/test-task-flow` 进行完整测试

2. **开始使用应用**
   - 创建需求
   - 申请任务
   - 管理申请
   - 跟踪进度

3. **监控和维护**
   - 定期检查数据库状态
   - 监控云函数调用
   - 收集用户反馈

---

**需要帮助？** 如果遇到问题，请查看控制台日志或联系技术支持。